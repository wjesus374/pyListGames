{% extends "base.html" %}

{% block content %}
    <h1 class="mt-4">Meus jogos</h1>

    <form action="{{ url_for('game.index') }}" method="get" class="mb-4">
        <div class="row">
            <!-- Nome do Jogo -->
            <div class="col-md-3">
                <div class="form-group">
                    <label for="name">Nome do Jogo</label>
                    <input type="text" class="form-control" name="name" id="name" value="{{ filters.get('name', '') }}" placeholder="Nome do jogo">
                </div>
            </div>
    
            <!-- Desenvolvedor -->
            <div class="col-md-3">
                <div class="form-group">
                    <label for="developer">Desenvolvedor</label>
                    <input type="text" class="form-control" name="developer" id="developer" value="{{ filters.get('developer', '') }}" placeholder="Desenvolvedor">
                </div>
            </div>
    
            <!-- Ano de Lançamento -->
            <div class="col-md-2">
                <div class="form-group">
                    <label for="release_year">Ano de Lançamento</label>
                    <input type="number" class="form-control" name="release_year" id="release_year" value="{{ filters.get('release_year', '') }}" placeholder="Ano">
                </div>
            </div>
    
            <!-- Gênero -->
            <div class="col-md-2">
                <div class="form-group">
                    <label for="genre">Gênero</label>
                    <input type="text" class="form-control" name="genre" id="genre" value="{{ filters.get('genre', '') }}" placeholder="Gênero">
                </div>
            </div>
    
            <!-- Plataforma com Múltipla Seleção -->
            <div class="col-md-2">
                <div class="form-group">
                    <label for="platform">Plataforma</label>
                    <select name="platform" id="platform" class="form-control" multiple>
                        {% for platform in platforms %}
                            <option value="{{ platform }}" {% if platform in filters.get('platform', []) %}selected{% endif %}>
                                {{ platform }}
                            </option>
                        {% endfor %}
                    </select>
                </div>
            </div>
        </div>
    
        <!-- Botão de Pesquisar -->
        <div class="row">
            <div class="col-md-12 text-right">
                <button type="submit" class="btn btn-primary">Pesquisar</button>
            </div>
        </div>
    </form>

    <a href="{{ url_for('game.download_favorites_csv') }}" class="btn btn-success">Baixar Favoritos como CSV</a>

    {% if games %}
    <table class="table table-striped table-bordered mt-3">
        <thead class="thead-dark">
            <tr>
                <th>Nome do Jogo</th>
                <th>Plataforma</th>
                <th>Minha Mídia</th>
                <th>Meu ranking</th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody>
            {% for user_game in games %}
            <tr>
                <td>{{ user_game.name }}</td>
                <td>{{ user_game.platform }}</td>
                <td>{{ user_game.media }}</td>
                <td>{{ user_game.rating }}/100</td>
                <td>
                    <form action="{{ url_for('game.remove_from_wishlist', game_id=user_game.id) }}" method="POST" style="display:inline;">
                        <button type="submit" class="btn btn-danger btn-sm">Remover</button>
                    </form>
                    <a href="{{ url_for('game.edit_wishlist', game_id=user_game.id) }}" class="btn btn-warning btn-sm">Editar</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
        <h1 class="mt-4">Você não tem nenhum jogo na sua lista</h1>
    {% endif %}
{% endblock %}
